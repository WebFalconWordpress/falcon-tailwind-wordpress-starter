!function(){var e={1135:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var s=typeof n;if("string"===s||"number"===s)e.push(n);else if(Array.isArray(n)&&n.length){var i=o.apply(null,n);i&&e.push(i)}else if("object"===s)for(var a in n)r.call(n,a)&&n[a]&&e.push(a)}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},4356:function(e,t,n){"use strict";function r(){return genesis_page_builder_globals.blockSettingsPermissions}function o(){var e=[];return wp.blocks.getBlockTypes().map((function(t){(t.name.startsWith("genesis-blocks")||t.name.startsWith("genesis-page-builder"))&&e.push(t)})),e=e.filter((function(e){return e.hasOwnProperty("gb_settings_data")||e.hasOwnProperty("gpb_settings_data")}))}function s(){return genesis_page_builder_globals.allRoles}n.d(t,{J1:function(){return o},dX:function(){return r},xJ:function(){return s}}),wp.hooks.addFilter("gb_should_render_block_setting","gpb",(function(e,t,n,o){var s=r();return void 0===s[t]||void 0===s[t][n]?e:o.roles.some((function(e){return!0===s[t][n][e]}))}))}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=n(4356),t=n(1135),r=n.n(t);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===o(t)?t:String(t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,_x,s,i=[],_n=!0,a=!1;try{if(_x=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;_n=!1}else for(;!(_n=(r=_x.call(n)).done)&&(i.push(r.value),i.length!==t);_n=!0);}catch(e){a=!0,o=e}finally{try{if(!_n&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(a)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=window.React,f=m.Component,y=m.useState,v=m.useEffect,__=wp.i18n.__,k=wp.components.Fill,h=wp.plugins.registerPlugin,E=wp.hooks.addAction,O=wp.data.dispatch,_=wp.apiFetch,w="block_settings_permissions",j=function(e){return m.createElement(m.Fragment,null,m.createElement("label",{className:"gb-checkbox-label"},m.createElement("input",{type:"checkbox",name:e.checkboxName,value:e.role.toLowerCase(),checked:e.checked,onChange:function(t){return e.onClick(t)},"data-setting":e.setting,"data-block":e.block}),e.role))},x=function(e){return m.createElement("fieldset",null,m.createElement("legend",{className:"screen-reader-text"},m.createElement("span",null,__("Roles","genesis-page-builder"))),Object.values(e.roles).map((function(t){var n=!0;if(void 0!==e.permissions[e.block]&&void 0!==e.permissions[e.block][e.setting.name]){var r=t.name.toLowerCase();n=e.permissions[e.block][e.setting.name][r]}return m.createElement(j,{key:"key_"+e.block+"_"+e.setting.name+"_"+t.name.toLowerCase(),block:e.block,role:t.name,setting:e.setting.name,checkboxName:"genesis-page-builder-settings[block_settings_permissions][".concat(e.block,"][").concat(e.setting.name,"][]"),checked:n,onClick:e.onClick})})))},P=function(e){var t=b(y(e.allExpanded||e.isOpen),2),n=t[0],o=t[1];return v((function(){var t=e.allExpanded||e.isOpen;o(t)}),[e.isOpen]),m.createElement("details",{key:"key_"+e.setting,className:r()("gpb-control-settings-control-settings-entry gb-admin-accordion-panel",n?"gpb-control-settings-entry-open":null),open:n},m.createElement("summary",{className:"gpb-control-settings-block-setting-summary"},m.createElement("h4",null,e.setting.title)),m.createElement("div",{className:"gpb-control-settings-block-permission gb-details-content"},m.createElement(x,{roles:e.roles,permissions:e.permissions,setting:e.setting,block:e.block.name,onClick:e.onClick})))},S=function(e){var t=b(y(e.isOpen),2),n=t[0],o=t[1];return v((function(){o(e.isOpen)}),[e.isOpen]),m.createElement(m.Fragment,null,m.createElement("details",{className:"gpb-control-settings-block gb-admin-accordion-panel",open:n},m.createElement("summary",{className:"gpb-control-settings-block-summary"},m.createElement("h3",null,e.block.title),m.createElement("div",{className:"gpb-control-settings-entry-header"},m.createElement("span",{class:"screen-reader-text"}," ",__("Block Settings Permissions","genesis-page-builder")))),m.createElement("div",{className:r()("gpb-control-settings-control-settings gb-details-content",n?"gpb-control-settings-control-settings-open":null)},void 0!==e.settings&&Object.keys(e.settings).map((function(t){return m.createElement(P,{key:"key_"+e.block.name+"_"+t,roles:e.roles,permissions:e.permissions,setting:{name:t,title:e.settings[t].title},block:e.block,onClick:e.onClick,isOpen:e.allExpanded,allExpanded:e.allExpanded})})))))},C=function(e){return m.createElement("div",{className:"gpb-control-settings-entry"},m.createElement(S,{roles:e.roles,settings:e.settings[e.block.name],permissions:e.permissions,block:e.block,onClick:e.onClick,isOpen:e.isOpen,allExpanded:e.allExpanded}))},N=function(e){return m.createElement("div",{className:"gpb-control-settings-entries"},e.blocks.map((function(t){return m.createElement(C,{key:"key_"+t.name,settings:e.settings,roles:e.roles,block:t,onClick:e.onClick,permissions:e.permissions,isOpen:e.allExpanded,allExpanded:e.allExpanded})})))},A=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}(this,u(t).call(this,e))).state={permissions:e.permissions||{},allExpanded:!1},n.updatePermissionsState=n.updatePermissionsState.bind(p(n)),n}var n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(t,e),n=t,(s=[{key:"updatePermissionsState",value:function(e){var t=O("genesis-blocks/global-settings").updateCustom,n=this.state.permissions;void 0===n[e.target.dataset.block]&&(n[e.target.dataset.block]={}),void 0===n[e.target.dataset.block][e.target.dataset.setting]&&(n[e.target.dataset.block][e.target.dataset.setting]={}),void 0===n[e.target.dataset.block][e.target.dataset.setting][e.target.value]&&(n[e.target.dataset.block][e.target.dataset.setting][e.target.value]={}),n[e.target.dataset.block][e.target.dataset.setting][e.target.value]=e.target.checked,this.setState({permissions:n}),t({key:w,value:n})}},{key:"render",value:function(){var e=this;return m.createElement("div",{className:"gpb-control-settings"},m.createElement("div",{className:"gpb-control-settings-head"},m.createElement("div",null,m.createElement("h2",null,__("Block Name","genesis-page-builder"))),m.createElement("div",null,m.createElement("button",{onClick:function(){e.setState({allExpanded:!0})},className:r()("gpb-control-settings-expand-all gb-admin-button-link aligned",this.state.allExpanded?"gpb-hidden":null)},__("Expand All","genesis-page-builder")),m.createElement("button",{onClick:function(){e.setState({allExpanded:!1})},className:r()("gpb-control-settings-collapse-all gb-admin-button-link aligned",this.state.allExpanded?"gpb-visible":null)},__("Collapse All","genesis-page-builder")))),m.createElement(N,{settings:this.props.settings,roles:this.props.roles,blocks:this.props.blocks,onClick:function(t){e.updatePermissionsState(t)},permissions:this.state.permissions,allExpanded:this.state.allExpanded}))}}])&&l(n.prototype,s),Object.defineProperty(n,"prototype",{writable:!1}),t}(f),T=function(e){var t={};return Object.values(e).map((function(e){void 0!==e.gb_settings_data&&(t[e.name]=e.gb_settings_data),void 0!==e.gpb_settings_data&&(t[e.name]=e.gpb_settings_data)})),t},B=function(t){if(Object.keys(t).length>0)return t;for(var n=Object.keys((0,e.xJ)()).reduce((function(e,t){return e[t]=!0,e}),{}),r=T((0,e.J1)()),o=0,s=Object.entries(r);o<s.length;o++){var a=b(s[o],2),l=a[0],c=a[1];for(var u in c)r[l][u]=i({title:r[l][u].title},n)}return r};h("genesis-pro-permission-settings",{render:function(){var t=(0,e.J1)(),n=(0,e.dX)();return m.createElement(k,{name:"GenesisBlocksSettings_block_permissions_section"},m.createElement(A,{blocks:t,settings:T(t),roles:(0,e.xJ)(),permissions:B(n)}))}}),E("genesisBlocks.savingSettings","genesisBlocks",(function(e,t){if(t.hasOwnProperty(w)){for(var n=0,r=Object.entries(t[w]);n<r.length;n++){var o=b(r[n],2),s=o[0],i=o[1];for(var a in i)delete t[w][s][a].title}_({path:"/genesis-page-builder/v1/block-permissions",method:"PUT",data:t[w]})}}))}()}();