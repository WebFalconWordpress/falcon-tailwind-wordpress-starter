(()=>{"use strict";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{getCustom:()=>u,getFormInfo:()=>m,getModifiedSettings:()=>b,getSections:()=>p,getSettings:()=>d});var s={};e.r(s),e.d(s,{resetFormSaveState:()=>_,saveSettings:()=>v,updateCustom:()=>h,updateSetting:()=>f});const n=window.wp.element,i=window.wp.i18n,l=window.wp.compose,a=window.wp.components,o=window.wp.data,c=window.wp.plugins,r=window.wp.dataControls,g={form:{fail:!1,success:!1,is_saving:!1},custom:[],modifiedSettings:[],...genesisBlocksSettingsData},d=e=>e.settings||{},u=e=>e.custom||{},m=e=>e.form||{};function p(e){return e.hasOwnProperty("sections")?e.sections:{}}const b=e=>e.modifiedSettings||[];function f(e){return{type:"UPDATE_SETTING",setting:e}}function h(e){return{type:"UPDATE_CUSTOM",setting:e}}function _(){return{type:"RESET"}}function*v(e){yield{type:"SAVING"};let t=null;try{wp.data.dispatch("core").saveSite(e),t=!0}catch(e){t=!1}return{type:"SAVED",success:t}}window.wp.coreData;const S={selectors:t,actions:s,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;return"UPDATE_CUSTOM"===t.type?{...e,custom:{...e.custom,[t.setting.key]:t.setting.value}}:"UPDATE_SETTING"===t.type?{...e,settings:{...e.settings,[t.setting.key]:t.setting.value},modifiedSettings:{...e.modifiedSettings,[t.setting.key]:t.setting.value}}:"SAVING"===t.type?{...e,form:{...e.form,fail:!1,success:!1,is_saving:!0}}:"SAVED"===t.type?{...e,form:{...e.form,success:!0===t.success,fail:!0!==t.success,is_saving:!1},modifiedSettings:t.success?[]:e.modifiedSettings}:"RESET"===t.type?{...e,form:{...e.form,fail:!1,success:!1,is_saving:!1}}:e},controls:r.controls},k=((0,o.registerStore)("genesis-blocks/global-settings",S),window.wp.a11y),y=window.wp.hooks,w=(0,l.compose)([(0,o.withSelect)((e=>({form:e("genesis-blocks/global-settings").getFormInfo(),settings:e("genesis-blocks/global-settings").getModifiedSettings(),custom:e("genesis-blocks/global-settings").getCustom()})))])((function(e){let{form:t,settings:s,custom:i,children:l,successMessage:c,failMessage:r,messageDuration:g}=e;const d=(0,n.useRef)();return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(a.Button,{isPrimary:!0,isBusy:t.is_saving,disabled:t.is_saving,onClick:function(){(0,y.doAction)("genesisBlocks.savingSettings",s,i),clearTimeout(d.current),(0,o.dispatch)("genesis-blocks/global-settings").saveSettings(s)},className:"genesis-blocks-settings-save has-notices"},l),t.success||t.fail?function(){d.current=setTimeout((()=>(0,o.dispatch)("genesis-blocks/global-settings").resetFormSaveState()),1e3*g);const e=t.success?c:r;(0,k.speak)(e,"polite");const s="genesis-blocks-save-notice"+(t.success?" success":"")+(t.fail?" fail":"");return(0,n.createElement)("span",{className:s},e)}():"")})),E=(0,l.compose)([(0,o.withDispatch)((()=>({onUpdate(e){(0,o.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}})))])((function(e){let{settings:t,field:s,onUpdate:i}=e;return(0,n.createElement)(a.CheckboxControl,{className:s.class,heading:s.heading,label:s.label,help:s.help,checked:!!t[s.id]&&t[s.id],onChange:e=>i({key:s.id,value:e})})})),C=window.lodash,T=window.wp.blockEditor,N=["image"],U=(0,i.__)("Image"),D=(0,i.__)("Select an image"),I=(0,i.__)("Choose image"),P=(0,i.__)("Replace image"),M=(0,i.__)("Remove image"),A=(0,o.withSelect)(((e,t)=>{const{getMedia:s}=e("core"),n=t.settings[t.field.id];return{media:n?s(n):null,imageId:n}})),O=(0,o.withDispatch)(((e,t)=>{const{updateSetting:s}=e("genesis-blocks/global-settings");return{onUpdateImage(e){s({key:t.field.id,value:e.id})},onRemoveImage(){s({key:t.field.id,value:null})}}})),F={checkbox:E,html:function(e){let{field:t}=e;return(0,n.createElement)("div",{dangerouslySetInnerHTML:{__html:t.content}})},image:(0,l.compose)(A,O)((function(e){let t,s,i,{field:l,imageId:o,media:c,onUpdateImage:r,onRemoveImage:g}=e;if(c){const e=l.image_size||"thumbnail";(0,C.has)(c,["media_details","sizes",e])?(t=c.media_details.sizes[e].width,s=c.media_details.sizes[e].height,i=c.media_details.sizes[e].source_url):(t=c.media_details.width,s=c.media_details.height,i=c.source_url)}return(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"genesis-blocks-settings-image"},(0,n.createElement)("p",{className:"components-base-control__label"},l.label||U),(0,n.createElement)(T.MediaUpload,{title:l.label_media_modal||D,onSelect:r,allowedTypes:N,render:e=>{let{open:r}=e;return(0,n.createElement)("div",{className:"genesis-blocks-settings-image__container"},(0,n.createElement)(a.Button,{className:o?"genesis-blocks-settings-image__preview":"genesis-blocks-settings-image__toggle",onClick:r,"aria-label":l.label_button_aria||null,isSecondary:!0},!!o&&c&&(0,n.createElement)(a.ResponsiveWrapper,{naturalWidth:t,naturalHeight:s,isInline:!0},(0,n.createElement)("img",{src:i,alt:""})),!!o&&!c&&(0,n.createElement)(a.Spinner,null),!o&&(l.label_button||I)))},value:o}),!!o&&c&&!c.isLoading&&(0,n.createElement)(T.MediaUpload,{title:l.label_media_modal||D,onSelect:r,allowedTypes:N,modalClass:"genesis-blocks-settings-image__media-modal",render:e=>{let{open:t}=e;return(0,n.createElement)(a.Button,{onClick:t,isSecondary:!0,"aria-label":l.label_replace_aria||null},l.label_replace||P)}}),!!o&&(0,n.createElement)(a.Button,{onClick:g,isLink:!0,isDestructive:!0,"aria-label":l.label_remove_aria||null},l.label_remove||M),!!l.help&&(0,n.createElement)("p",{id:l.id+"__help",className:"components-base-control__help"},l.help)))})),radio:(0,l.compose)([(0,o.withDispatch)((()=>({onUpdate(e){(0,o.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}})))])((function(e){let{settings:t,field:s,onUpdate:i}=e;return(0,n.createElement)(a.RadioControl,{className:s.class,label:s.label,help:s.help,selected:!!t[s.id]&&t[s.id],options:function(e){const t=[];for(const[s,n]of Object.entries(e))t.push({value:s,label:n});return t}(s.options),onChange:e=>i({key:s.id,value:e})})})),select:(0,l.compose)([(0,o.withDispatch)((()=>({onUpdate(e){(0,o.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}})))])((function(e){let{settings:t,field:s,onUpdate:i}=e;return(0,n.createElement)(a.SelectControl,{className:s.class,label:s.label,help:s.help?s.help:"",value:!!t[s.id]&&t[s.id],options:function(e){const t=[];for(const[s,n]of Object.entries(e))t.push({value:s,label:n});return t}(s.options),onChange:e=>i({key:s.id,value:e})})})),text:(0,l.compose)([(0,o.withDispatch)((()=>({onUpdate(e){(0,o.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}})))])((function(e){let{settings:t,field:s,onUpdate:i}=e;return(0,n.createElement)(a.TextControl,{className:s.class,label:s.label?s.label:"",help:s.help?s.help:"",onChange:e=>i({key:s.id,value:e}),value:t[s.id]?t[s.id]:""})})),textarea:(0,l.compose)([(0,o.withDispatch)((()=>({onUpdate(e){(0,o.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}})))])((function(e){let{settings:t,field:s,onUpdate:i}=e;return(0,n.createElement)(a.TextareaControl,{className:s.class,label:s.label?s.label:"",help:s.help?s.help:"",onChange:e=>i({key:s.id,value:e}),value:t[s.id]?t[s.id]:""})}))},B=(0,l.compose)([(0,o.withSelect)((()=>({settings:(0,o.select)("genesis-blocks/global-settings").getSettings(),sections:(0,o.select)("genesis-blocks/global-settings").getSections()})))])((function(e){let{settings:t,sections:s}=e;return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(a.TabPanel,{className:"genesis-blocks-settings-sections",activeClass:"gb-nav-tab-active",onSelect:function(){(0,o.dispatch)("genesis-blocks/global-settings").resetFormSaveState()},tabs:Object.values(function(e){for(const t in e)e[t].className="gb-nav-tab gb-admin-button";return e}(s))},(e=>(0,n.createElement)("div",{className:"gb-admin-plugin-admin-body"},(0,n.createElement)("div",{className:"gb-admin-plugin-container"},function(e){if(e.hasOwnProperty("fields")&&Array.isArray(e.fields)){const s=e.fields.map((function(e,s){if(!F.hasOwnProperty(e.type))return"";const i=F[e.type];return(0,n.createElement)(i,{key:s,settings:t,field:e})}));if(s.length>0)return(0,n.createElement)(n.Fragment,null,s)}return(0,n.createElement)("p",null,(0,i.__)("No fields found for this section.","genesis-blocks"))}(e),(0,n.createElement)(a.SlotFillProvider,null,(0,n.createElement)(a.Slot,{name:"GenesisBlocksSettings_"+e.name.replace("genesis_blocks_settings_","")}),(0,n.createElement)(c.PluginArea,null)),(0,n.createElement)(w,{successMessage:(0,i.__)("Settings saved","genesis-blocks"),failMessage:(0,i.__)("Saving failed","genesis-blocks"),messageDuration:"2"},(0,i.__)("Save All","genesis-blocks")))))))}));(0,n.render)((0,n.createElement)(B,null),document.getElementById("root"))})();